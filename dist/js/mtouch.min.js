!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.up=e():t.up=e()}(this,function(){return function(t){function e(n){if(i[n])return i[n].exports;var s=i[n]={exports:{},id:n,loaded:!1};return t[n].call(s.exports,s,s.exports,e),s.loaded=!0,s.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){t.exports=i(2)},function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),s=function(){function t(e){i(this,t),this.handlers=[],this.el=e}return n(t,[{key:"add",value:function(t){return this.handlers.push(t),this}},{key:"del",value:function(t){var e=this;return t?this.handlers.forEach(function(i,n){i===t&&e.handlers.splice(n,1)}):this.handlers=[],this}},{key:"fire",value:function(){var t=this,e=arguments;if(this.handlers&&0!==!this.handlers.length)return this.handlers.forEach(function(i){"function"==typeof i&&i.apply(t.el,e)}),this}}]),t}();e.default=s},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),o=i(3),a=n(o),h=i(1),u=n(h);window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}();var c=["touchstart","touchmove","touchend","drag","dragstart","dragend","pinch","pinchstart","pinchend","rotate","rotatestart","rotatend","singlePinch","singlePinchstart","singlePinchend","singleRotate","singleRotatestart","singleRotatend"],l=function(){function t(e){s(this,t),this.ops={receiver:null,operator:null,delegation:!1,limit:null,transform:{x:0,y:0,scale:1,rotate:0},touchstart:function(){},touchmove:function(){},touchend:function(){},drag:function(){},dragstart:function(){},dragend:function(){},pinch:function(){},pinchstart:function(){},pinchend:function(){},rotate:function(){},rotatestart:function(){},rotatene:function(){},singlePinch:function(){},singlePinchstart:function(){},singlePinchend:function(){},singlePinchId:null,singleRotate:function(){},singleRotatestart:function(){},singleRotatend:function(){},singleRotateId:null},this.ops=a.default.extend(this.ops,e),this.transform=this.ops.transform,this.use={drag:!!e.drag,pinch:!!e.pinch,rotate:!!e.rotate,singlePinch:!!e.singlePinch&&!!e.singlePinchId,singleRotate:!!e.singleRotate&&!!e.singleRotateId},this.receiver="string"==typeof this.ops.receiver?document.querySelector(this.ops.receiver):this.ops.receiver,this.receiverStatus=this.receiver.getBoundingClientRect(),this.ops.operator?(this.ops.delegation=!0,this.operator=document.querySelector(this.ops.operator),this.operatorStatus=this.operator.getBoundingClientRect()):(this.ops.delegation=!1,this.operator=this.receiver,this.operatorStatus=this.receiverStatus),this.event={origin:null,transform:this.transform,eventType:"",delta:{},setTransform:this.setTransform.bind(this)},this.fingers=0,this.draging=this.pinching=this.rotating=this.singleRotating=this.singlePinching=!1,this.startScale=1,this.startPoint={},this.secondPoint={},this.pinchStartLength=null,this.singlePinchStartLength=null,this.vertor1={},this.singleBasePoint={},this.driveBus(),this.bind()}return r(t,[{key:"driveBus",value:function(){var t=this,e=function(){};c.forEach(function(i){t[i]=new u.default(t.receiver).add(t.ops[i]||e)})}},{key:"bind",value:function(){var t=this;["touchstart","touchmove","touchend","touchcancel"].forEach(function(e){var i="touchcancel"==e?"end":e.replace("touch","");t.receiver.addEventListener(e,t[i].bind(t),!1)})}},{key:"start",value:function(t){if(t.touches&&"touchstart"===t.type){if(this.fingers=t.touches.length,this.startPoint=a.default.getPoint(t,0),this.singleBasePoint=a.default.getBasePoint(this.operator),this.transform=a.default.getPos(this.operator),this.fingers>1)this.secondPoint=a.default.getPoint(t,1),this.vertor1=a.default.getVertor(this.secondPoint,this.startPoint),this.pinchStartLength=a.default.getLength(this.vertor1);else if(this.use.singlePinch){var e=a.default.getVertor(this.startPoint,this.singleBasePoint);this.singlePinchStartLength=a.default.getLength(e)}this.event.origin=t,this.event.eventType="touchstart",this.touchstart.fire(this.event)}}},{key:"move",value:function(t){if(t.touches&&"touchmove"===t.type){var e=a.default.getPoint(t,0),i=t.touches.length,n=void 0,s=void 0,r=void 0,o=void 0,h=void 0;if(this.event.origin=t,i<this.fingers)return this.startPoint=e,void(this.fingers=i);if(!(i>1)||this.secondPoint&&this.vertor1&&this.pinchStartLength||(this.secondPoint=a.default.getPoint(t,1),this.vertor1=a.default.getVertor(this.secondPoint,this.startPoint),this.pinchStartLength=a.default.getLength(this.vertor1)),i>1){var u=a.default.getPoint(t,1),c=a.default.getVertor(u,e);this.use.pinch&&(o=a.default.getLength(c),this.event.delta={scale:o/this.pinchStartLength},this.transform.scale*=this.event.delta.scale,this.event.transform=this.transform,this.pinchStartLength=o,this.eventFire("pinch",this.event)),this.use.rotate&&(this.event.delta={rotate:a.default.getAngle(this.vertor1,c)},this.transform.rotate+=this.event.delta.rotate,this.event.transform=this.transform,this.vertor1=c,this.eventFire("rotate",this.event))}else this.use.singlePinch&&t.target.id==this.ops.singlePinchId&&(r=a.default.getVertor(e,this.singleBasePoint),h=a.default.getLength(r),this.event.delta={scale:h/this.singlePinchStartLength},this.transform.scale*=this.event.delta.scale,this.event.transform=this.transform,this.singlePinchStartLength=h,this.eventFire("singlePinch",this.event)),this.use.singleRotate&&t.target.id==this.ops.singleRotateId&&(n=a.default.getVertor(this.startPoint,this.singleBasePoint),s=a.default.getVertor(e,this.singleBasePoint),this.event.delta={rotate:a.default.getAngle(n,s)},this.transform.rotate+=this.event.delta.rotate,this.event.transform=this.transform,this.eventFire("singleRotate",this.event));this.use.drag&&t.target.id!==this.ops.singlePinchId&&t.target.id!==this.ops.singleRotateId&&(this.event.delta={deltaX:e.x-this.startPoint.x,deltaY:e.y-this.startPoint.y},this.transform.x+=this.event.delta.deltaX,this.transform.y+=this.event.delta.deltaY,this.event.transform=this.transform,this.eventFire("drag",this.event)),this.startPoint=e,this.event.eventType="touchmove",this.touchmove.fire(this.event),t.preventDefault()}}},{key:"end",value:function(t){var e=this;(t.touches||"touchend"===t.type||"touchcancel"===t.type)&&(this.event.origin=t,["pinch","drag","rotate","singleRotate","singlePinch"].forEach(function(t){e.eventEnd(t,e.event)}),this.event.eventType="touchend",this.touchend.fire(this.event))}},{key:"eventFire",value:function(t,e){var i=t+"ing",n=t+"start";this[i]?(e.eventType=t,this[t].fire(e)):(e.eventType=n,this[n].fire(e),this[i]=!0)}},{key:"eventEnd",value:function(t,e){var i=t+"ing",n=void 0;n="rotate"==t||"singleRotate"==t?t+"nd":t+"end",this[i]&&(e.eventType=n,this[n].fire(e),this[i]=!1)}},{key:"setTransform",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.operator,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.transform,i=JSON.parse(JSON.stringify(e));this.ops.limit&&this.ops.delegation&&"drag"==this.event.eventType&&(i=this.limitOperator(i)),a.default.setPos(t,this.limitOperator(i))}},{key:"limitOperator",value:function(t){var e=this.operator.getBoundingClientRect(),i=this.operatorStatus.width*(t.scale-1)/2,n=this.operatorStatus.height*(t.scale-1)/2,s=e.width*this.ops.limit.x,r=e.height*this.ops.limit.y,o=i-s,a=n-r,h=this.receiverStatus.width-e.width+i+s,u=this.receiverStatus.height-e.height+n+r,c=this.ops.limit,l=c.minScale,d=c.maxScale;return(this.ops.limit.x||0==this.ops.limit.x)&&(t.x>=h&&(t.x=h),t.x<o&&(t.x=o)),(this.ops.limit.y||0==this.ops.limit.y)&&(t.y>u&&(t.y=u),t.y<a&&(t.y=a)),this.ops.limit.minScale&&t.scale<l&&(t.scale=l),this.ops.limit.maxScale&&t.scale>d&&(t.scale=d),t}},{key:"switchOperator",value:function(t){this.operator=t}},{key:"on",value:function(t,e){this[t]&&this[t].add(e)}},{key:"off",value:function(t,e){this[t]&&this[t].del(e)}}]),t}();e.default=l,window.MTPlugin||(window.MTPlugin={}),window.MTPlugin.Mtouch=l},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={getLength:function(t){return t?Math.sqrt(t.x*t.x+t.y*t.y):void console.error("getLength error!")},getAngle:function(t,e){if(!t||!e)return void console.error("getAngle error!");var i=t.x*e.y-e.x*t.y;i=i>0?1:-1;var n=Math.sqrt(t.x*t.x+t.y*t.y),s=Math.sqrt(e.x*e.x+e.y*e.y),r=n*s;if(0===r)return 0;var o=t.x*e.x+t.y*e.y,a=o/r;return a>1&&(a=1),a<-1&&(a=-1),Math.acos(a)*i*180/Math.PI},getBasePoint:function(t){if(!t)return void console.error("getBasePoint error!");var e=t.getBoundingClientRect().left+t.getBoundingClientRect().width/2,i=t.getBoundingClientRect().top+t.getBoundingClientRect().width/2;return{x:Math.round(e),y:Math.round(i)}},setPos:function(t,e){var i=JSON.stringify(e),n="translate3d("+e.x+"px,"+e.y+"px,0px) scale("+e.scale+") rotate("+e.rotate+"deg)";t="string"==typeof t?document.querySelector(t):t,t.style.transform=n,t.setAttribute("data-mtouch-status",i)},getPos:function(t){return JSON.parse(t.getAttribute("data-mtouch-status"))||{x:0,y:0,scale:1,rotate:0}},extend:function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t},getVertor:function(t,e){return t&&e?{x:Math.round(t.x-e.x),y:Math.round(t.y-e.y)}:void console.error("getVertor error!")},getPoint:function(t,e){return t&&t.touches[e]?{x:Math.round(t.touches[e].pageX),y:Math.round(t.touches[e].pageY)}:void console.error("getPoint error!")}}}])});